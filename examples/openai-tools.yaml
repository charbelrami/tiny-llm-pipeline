# yaml-language-server: $schema=../schema.json
# Tool-calling loop is implemented inside registry.models.openai in
# examples/run-openai-tools.mjs.
steps:
  - type: set
    var: city
    value: Boston, MA

  - type: set
    var: prompt
    value: What is the weather like in {{city}} today?

  - type: llm
    model: openai
    from: prompt
    params:
      model: gpt-4.1
      tool_choice: auto
      tools:
        - type: function
          name: get_current_weather
          description: Get the current weather in a given location
          parameters:
            type: object
            properties:
              location:
                type: string
                description: The city and state, e.g. San Francisco, CA
              unit:
                type: string
                enum: [celsius, fahrenheit]
            required: [location, unit]
            additionalProperties: false
          strict: true
    var: weather_summary

  - type: output
    pick: weather_summary
